{"version":3,"sources":["index.tsx"],"names":["Detector","NativeModules","EventsName","detectorEventEmitter","NativeEventEmitter","commonAddScreenshotListener","listener","eventSubscription","addListener","UserDidTakeScreenshot","remove","getListenersCount","listenerCount","listeners","length","startScreenshotDetection","stopScreenshotDetection","addScreenshotListener","Platform","select","default","ios","android","unsubscribe"],"mappings":";;;;;;;AAAA;;AAEA,MAAM;AAAEA,EAAAA;AAAF,IAAeC,0BAArB;IAEKC,U;;WAAAA,U;AAAAA,EAAAA,U;GAAAA,U,KAAAA,U;;AAIL,MAAMC,oBAAoB,GAAG,IAAIC,+BAAJ,CAAuBJ,QAAvB,CAA7B;;AAIA,MAAMK,2BAA2B,GAAIC,QAAD,IAAuC;AACzE,QAAMC,iBAAiB,GAAGJ,oBAAoB,CAACK,WAArB,CACxBN,UAAU,CAACO,qBADa,EAExB,MAAMH,QAAQ,EAFU,EAGxB,EAHwB,CAA1B;AAMA,SAAO,MAAM;AACXC,IAAAA,iBAAiB,CAACG,MAAlB;AACD,GAFD;AAGD,CAVD;;AAYA,MAAMC,iBAAiB,GAAG,MAAc;AAAA;;AACtC,SACE;AACA;AAFF,+DAGER,oBAAoB,CAACS,aAHvB,2DAGE,4BAAAT,oBAAoB,EAAiBD,UAAU,CAACO,qBAA5B,CAHtB,yEAIE;AACA;AALF,8BAMEN,oBAAoB,CAACU,SANvB,2DAME,4BAAAV,oBAAoB,EAAaD,UAAU,CAACO,qBAAxB,CAApB,CAAmEK,MANrE,uCAOE;AAPF;AASD,CAVD;;AAYO,MAAMC,wBAAwB,GAAG,MAAM;AAC5Cf,EAAAA,QAAQ,CAACe,wBAAT;AACD,CAFM;;;;AAIA,MAAMC,uBAAuB,GAAG,MAAM;AAC3ChB,EAAAA,QAAQ,CAACgB,uBAAT;AACD,CAFM;;;;AAIA,MAAMC,qBAAqB,GAAGC,sBAASC,MAAT,CAEnC;AACAC,EAAAA,OAAO,EAAE,MAAmB,MAAM,CAAE,CADpC;AAEAC,EAAAA,GAAG,EAAEhB,2BAFL;AAGAiB,EAAAA,OAAO,EAAGhB,QAAD,IAAuC;AAC9C,QAAIK,iBAAiB,OAAO,CAA5B,EAA+B;AAC7BX,MAAAA,QAAQ,CAACe,wBAAT;AACD;;AAED,UAAMQ,WAAwB,GAAGlB,2BAA2B,CAACC,QAAD,CAA5D;AAEA,WAAO,MAAM;AACXiB,MAAAA,WAAW;;AAEX,UAAIZ,iBAAiB,OAAO,CAA5B,EAA+B;AAC7BX,QAAAA,QAAQ,CAACgB,uBAAT;AACD;AACF,KAND;AAOD;AAjBD,CAFmC,CAA9B","sourcesContent":["import { NativeModules, NativeEventEmitter, Platform } from 'react-native';\n\nconst { Detector } = NativeModules;\n\nenum EventsName {\n  UserDidTakeScreenshot = 'UIApplicationUserDidTakeScreenshotNotification',\n}\n\nconst detectorEventEmitter = new NativeEventEmitter(Detector);\n\ntype Unsubscribe = () => void;\n\nconst commonAddScreenshotListener = (listener: () => void): Unsubscribe => {\n  const eventSubscription = detectorEventEmitter.addListener(\n    EventsName.UserDidTakeScreenshot,\n    () => listener(),\n    {}\n  );\n\n  return () => {\n    eventSubscription.remove();\n  };\n};\n\nconst getListenersCount = (): number => {\n  return (\n    // React Native 0.64+\n    // @ts-ignore\n    detectorEventEmitter.listenerCount?.(EventsName.UserDidTakeScreenshot) ??\n    // React Native < 0.64\n    // @ts-ignore\n    detectorEventEmitter.listeners?.(EventsName.UserDidTakeScreenshot).length ??\n    0\n  );\n};\n\nexport const startScreenshotDetection = () => {\n  Detector.startScreenshotDetection()\n}\n\nexport const stopScreenshotDetection = () => {\n  Detector.stopScreenshotDetection()\n}\n\nexport const addScreenshotListener = Platform.select<\n  (listener: () => void) => Unsubscribe\n>({\n  default: (): Unsubscribe => () => {},\n  ios: commonAddScreenshotListener,\n  android: (listener: () => void): Unsubscribe => {\n    if (getListenersCount() === 0) {\n      Detector.startScreenshotDetection();\n    }\n\n    const unsubscribe: Unsubscribe = commonAddScreenshotListener(listener);\n\n    return () => {\n      unsubscribe();\n\n      if (getListenersCount() === 0) {\n        Detector.stopScreenshotDetection();\n      }\n    };\n  },\n});\n"]}